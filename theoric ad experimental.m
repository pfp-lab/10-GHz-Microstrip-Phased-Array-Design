clc
clear
close all
fo=10e9;
w=2*pi*fo;
epso=8.85e-12;
mio=4*pi*1e-7;
k=w*sqrt(epso*mio)
vp=1/sqrt(epso*mio)
lambda=vp/fo;
d=0.75*lambda
r=1000;
theta=-pi/2:pi/180:pi/2;
thetao=10*pi/180;
psi=0;
for j=1:4
   a(j,:)=exp(-1i*k*(r*cos(theta-thetao))).*exp(1i*k*(j-1)*d*sin(thetao));
   bi(j,:)=a(j,:).*exp(1i*k*(r-(j-1)*d.*sin(theta)));
   psi=psi+bi(j,:);
end
figure(1)
plot(180/pi*theta, 20*log10(abs(psi)))
xlabel('Theta')
ylabel('Psi [db]')
title('Radiation diagram')
figure(2)
plot(180/pi*theta, 20*log10(abs(psi)/max(abs(psi))))
xlabel('Theta')
ylabel('Psi [db]')
title('Normalized radiation pattern')
grid on;
data=[
-29.862130352420962,
-23.891744432129581,
-20.446620652386578,
-18.044516265381208,
-16.217890369606540,
-14.757855157830539,
-13.553529702914696,
-12.539609377087972,
-11.674812087843126,
-10.931651222007234,
-10.291092138423585,
-9.739556367455386,
-9.267144284567252,
-8.866526766754703,
-8.532219422608984,
-8.260080679731109,
-8.046939701764392,
-7.890293255013493,
-7.788026732298413,
-7.738120480907101,
-7.738301871926666,
-7.785598584724840,
-7.875742739156188,
-8.002376195048619,
-8.156030952098508,
-8.322936792070134,
-8.483888622883478,
-8.613723419734665,
-8.682335144836829,
-8.658243371259779,
-8.514905608121921,
-8.238007619775209,
-7.830183665106390,
-7.310300771445667,
-6.707764113881000,
-6.055176405051928,
-5.382613115877144,
-4.714738597983142,
-4.070258357344789,
-3.462653625388523,
-2.901353744305759,
-2.392884394248636,
-1.941813584159747,
-1.551467454673497,
-1.224447870075427,
-0.962997827331758,
-0.769255926782397,
-0.645430451065691,
-0.593911765984316,
-0.617329416185981,
-0.718545745276229,
-0.900557429462324,
-1.166243517294796,
-1.517842603864925,
-1.955945992182381,
-2.477638876982507,
-3.073211746277644,
-3.720730100052517,
-4.378245938191000,
-4.976007986877345,
-5.417319536160822,
-5.602332443220949,
-5.475677998627067,
-5.061950262788430,
-4.450012764623541,
-3.744246940917376,
-3.028580665268328,
-2.357310772249803,
-1.760513560208194,
-1.252096147484979,
-0.835841776162260,
-0.508875510253308,
-0.263124918126839,
-0.085408980235104,
0.043306016899451,
0.148860178739448,
0.264094966057853,
0.426890870760108,
0.674771404695347,
1.036394570294901,
1.523175111688415,
2.125887640862718,
2.818556538211035,
3.567028711414443,
4.337363074003688,
5.100971810288531,
5.836325480762831,
6.528493808344521,
7.167809751214070,
7.748434392248279,
8.267148877531808,
8.722445500525222,
9.113884256068120,
9.441652981536661,
9.706272598613651,
9.908401487887849,
10.048705710341231,
10.127771931999154,
10.146047252009746,
10.103795176640821,
10.001060323964184,
9.837636589017871,
9.613034815482870,
9.326446761403973,
8.976702484939541,
8.562218334067421,
8.080932611135706,
7.530225847471775,
6.906822747423836,
6.206673863394848,
5.424818350757247,
4.555237972778869,
3.590734474709379,
2.522915526283999,
1.342501873722843,
0.040474216494217,
-1.388694068402584,
-2.938822019667821,
-4.572795205472722,
-6.184059839561130,
-7.548271944581744,
-8.353992151915749,
-8.430444171798854,
-7.935913884722250,
-7.180773374078036,
-6.393367728056975,
-5.682964714759544,
-5.087423969821611,
-4.612534191402659,
-4.251843028955785,
-3.995159767950441,
-3.831906824412074,
-3.752310059095336,
-3.747717209349041,
-3.810581201944425,
-3.934328465311759,
-4.113200397594268,
-4.342101156407574,
-4.616462163333263,
-4.932124537809165,
-5.285237252718764,
-5.672167805593202,
-6.089422212358769,
-6.533571578861465,
-7.001183188011547,
-7.488754930771356,
-7.992653062869851,
-8.509054771074798,
-9.033898950408464,
-9.562850914347383,
-10.091289304450859,
-10.614325782269075,
-11.126869363241951,
-11.623746330431922,
-12.099882270917901,
-12.550544074575852,
-12.971627158067395,
-13.359959185285971,
-13.713580662108896,
-14.031960259147839,
-14.316112098565062,
-14.568602911668718,
-14.793463632104473,
-14.996044904491967,
-15.182872912366790,
-15.361569242651312,
-15.540899865092262,
-15.731021110553584,
-15.944004039940422,
-16.194753696639268,
-16.502511849949858,
-16.893269156978910,
-17.403677252517543,
-18.087600949244774,
-19.027751090740878,
-20.358499556419684,
-22.318664419322396,
-25.410399008146747,
-31.150256756606787
];
figure(3)
plot(data)
hold on
plot(20*log10(abs(psi)))
xlabel('Theta')
ylabel('[db]')
title('Radiation diagram - theoretical and experimental comparison')
